<VirtualHost *:80>
    DocumentRoot /var/www/html
    RewriteEngine On
    DirectoryIndex index.html index.php

    <Directory /var/www/html>
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted

        # Règle pour les requêtes API
        RewriteRule ^api/(.*)$ api/index.php?path=$1 [QSA,L]

        # Rediriger la racine vers src/public/index.html si ce n'est pas un fichier/dossier existant
        RewriteCond %{REQUEST_URI} ^/$
        RewriteRule ^$ src/public/index.html [L]

        # Règle pour les requêtes non-API (vers le répertoire public)
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteCond %{REQUEST_FILENAME} !-d
        RewriteRule ^(.*)$ src/public/$1 [QSA,L]
    </Directory>

    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>
